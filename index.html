<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="UTF-8">
    <title>Gestione Lavori</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>

    <!-- HEADER -->
    <header class="p-3 mb-4">
      <div class="container d-flex align-items-center justify-content-between">
        <div class="d-flex align-items-center">
          <img src="logo.png" alt="Logo" width="196" height="90" class="me-3 logo-img">
          <h1 class="h4 m-0">Gestione Lavori</h1>
        </div>
        <nav>
          <a href="index.html" class="text-white text-decoration-none mx-2">Home</a>
          <a href="dashboard.html" class="text-white text-decoration-none mx-2">Dashboard</a>
        </nav>
      </div>
    </header>
    
    <div class="container my-5">

      <!-- Toast container -->
      <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 9999">
        <div id="toastContainer"></div>
      </div>

      
      <button id="addBtn" class="btn btn-primary my-2">Aggiungi Nuovo</button>

      <!-- FILTERS -->
      <div class="row my-3 align-items-end">
        <div class="col-md-3">
          <input type="text" id="searchInput" class="form-control" placeholder="Cerca lavoro o cliente...">
        </div>
        <div class="col-md-3">
          <select id="finitoFilter" class="form-select">
            <option value="all">Tutti gli stati</option>
            <option value="true">Finiti</option>
            <option value="false">In lavorazione</option>
          </select>
        </div>
        <div class="col-md-3"> 
          <select id="tecnicoFilter" class="form-select">
            <option value="all">Tutti i tecnici</option>
          </select>
        </div>
        <div class="col-md-3">
          <button id="resetFiltersBtn" class="btn btn-secondary w-100">Reset filtri</button>
        </div>
      </div>
      
      <!-- INFO -->
      <div id="statsBox" class="alert alert-info d-flex justify-content-between align-items-center p-3 my-3">
        <div>Totale lavori: <strong id="totalCount">0</strong></div>
        <div>Finiti: <strong id="finitiCount">0</strong></div>
        <div>In lavorazione: <strong id="nonFinitiCount">0</strong></div>
      </div>
      
      <!-- TABLE -->
      <table class="table table-bordered" id="impiantiTable">
        <thead>
          <tr id="tableHeader">
            <th data-key="tecnicoId" data-label="Tecnico">Tecnico</th>
            <th data-key="cliente" data-label="Cliente">Cliente</th>
            <th data-key="nomeImpianto" data-label="Nome Impianto">Nome Lavoro</th>
            <th data-key="schemiElettrici" data-label="Schemi elettrici(%)">Schemi elettrici(%)</th>
            <th data-key="programmazione" data-label="Programmazione(%)">Programmazione(%)</th>
            <th data-key="dataAvviamento"data-label="Data Previsto Avviamento">Data Previsto Avviamento</th>
            <th data-key="finito" data-label="Finito">Finito</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
    
    <!-- MODAL -->
    <div class="modal fade" id="addModal" tabindex="-1" aria-labelledby="addModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <form class="modal-content" id="addForm">
          <div class="modal-header">
            <h5 class="modal-title" id="addModalLabel">Nuovo Lavoro</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Chiudi"></button>
          </div>
          <div class="modal-body">
            <select class="form-select my-2" name="tecnico" id="tecnicoSelect" required></select>
            <input class="form-control my-2" name="cliente" placeholder="Cliente" required />
            <input class="form-control my-2" name="nomeImpianto" placeholder="Nome Lavoro" required />
            <input class="form-control my-2" name="schemiElettrici" type="number" placeholder="Schemi elettrici (%)" required />
            <input class="form-control my-2" name="programmazione" type="number" placeholder="Programmazione (%)" required />
            <input class="form-control my-2" id="dataAvviamentoInput" name="dataAvviamento" placeholder="Seleziona una data" required />
            <input class="form-control my-2" name="note" placeholder="Note"/>
            <div class="form-check my-2">
              <input class="form-check-input" type="checkbox" name="finito" id="finitoCheck">
              <label class="form-check-label" for="finitoCheck">Finito</label>
            </div>
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn btn-primary">Salva</button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>
          </div>
        </form>
      </div>
    </div>
    
    <!-- FOOTER -->
    <footer class="bg-light text-center text-muted py-3 mt-5 border-top">
      <div>
        <small>&copy; 2025 - Gestione Lavori â€¢ ATIX S.r.l.</small>
      </div>
      <div class="mt-1">
        <a href="https://marcomanfrin.me" class="text-muted text-decoration-none" target="_blank">Sviluppato da Marco Manfrin</a>
      </div>
    </footer>
    
    <!-- SCRIPTS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="script.js"></script>
  </body>
</html>
